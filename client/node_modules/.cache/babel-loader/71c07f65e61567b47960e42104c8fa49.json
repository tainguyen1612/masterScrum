{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/macbook/Documents/WebEnterPrise/client/src/components/screens/Resubmit.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport \"./RegisterScreen.css\"; // import { handleUpload } from'../constant/uploadWord';\n\nimport { storage } from \"../config/firebase\";\nimport alert from '../constant/alert';\nimport moment from 'moment';\n\nconst ReSubmitReport = ({\n  match\n}) => {\n  _s();\n\n  const [pdf, setPdf] = useState(null);\n  const [time, setTime] = useState();\n  const [title, setTitle] = useState({\n    title: \"\"\n  });\n  const [showResults, setShowResults] = useState(false);\n\n  const onClick = () => setShowResults(true);\n\n  const handleChange = e => {\n    if (e.target.files[0]) {\n      setPdf(e.target.files[0]);\n    }\n  };\n\n  function handle(e) {\n    const newData = { ...title\n    };\n    newData[e.target.id] = e.target.value;\n    setTitle(newData);\n  }\n\n  const config = {\n    headers: {\n      \"Content-Type\": \"application/json\",\n      token: localStorage.getItem(\"authToken\")\n    }\n  };\n\n  const handleUpload = (pdf, title) => {\n    const uploadTask = storage.ref(`pdfs/${pdf.name}`).put(pdf);\n    uploadTask.on(\"state_changed\", snapshot => {\n      const progress = Math.round(snapshot.bytesTransferred / snapshot.totalBytes * 100);\n    }, error => {\n      alert(\"can not upload pdf\", \"error\");\n      console.log(error);\n    }, () => {\n      storage.ref(\"pdfs\").child(pdf.name).getDownloadURL().then(async url => {\n        const {\n          data\n        } = await axios.patch(`/homeStudent/lstFaculty/report/upload/${match.params.reportID}`, {\n          title: title,\n          reportUrl: url\n        }, config);\n\n        if (data.success === true) {\n          alert(data.message, \"success\");\n        }\n      });\n    });\n  };\n\n  useEffect(async () => {\n    const end = moment(match.params.endtime);\n    const cur = moment();\n    let checkTime = end.diff(cur, 'days');\n    console.log(checkTime);\n\n    if (checkTime < 0) {\n      checkTime = 0;\n    }\n\n    setTime(checkTime);\n\n    try {\n      const single = await axios.get(`/homeStudent/${match.params.reportID}`, config);\n      setPdf(single.data);\n      setTitle(single.data);\n    } catch (error) {\n      console.log(\"error\");\n    }\n  }, []);\n  return (\n    /*#__PURE__*/\n    // <div>\n    //   <input type=\"file\" onChange={handleChange} />\n    //   <p>{time}</p>\n    //   <button onClick={e => handleUpload(pdf)}>Upload</button>\n    // </div>\n    _jsxDEV(\"div\", {\n      className: \"data\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"title\",\n        children: \"Faculty / Re-Submit Report\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"register-screen\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"register-screen__form\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"email\",\n              children: \"Time to upload\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 96,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                color: \"red\"\n              },\n              children: [\"You have \", time, \" day to submit report\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"name\",\n              children: \"Title:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"title\",\n              required: true,\n              id: \"title\",\n              value: title.title,\n              onChange: e => handle(e)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 101,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"name\",\n              children: \"File:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              name: \"fileName\",\n              required: true,\n              id: \"fileName\",\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 112,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            value: \"law\",\n            name: \"law\",\n            onClick: onClick\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 11\n          }, this), \" Accept all law of university\", showResults ? /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: e => handleUpload(pdf, title.title),\n            className: \"btn btn-primary\",\n            children: \" Re-Submit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 27\n          }, this) : null]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 5\n    }, this)\n  );\n};\n\n_s(ReSubmitReport, \"vLnICCoojkCRNyR6fLn1Meja6zg=\");\n\n_c = ReSubmitReport;\nexport default ReSubmitReport;\n\nvar _c;\n\n$RefreshReg$(_c, \"ReSubmitReport\");","map":{"version":3,"sources":["/Users/macbook/Documents/WebEnterPrise/client/src/components/screens/Resubmit.js"],"names":["useState","useEffect","axios","storage","alert","moment","ReSubmitReport","match","pdf","setPdf","time","setTime","title","setTitle","showResults","setShowResults","onClick","handleChange","e","target","files","handle","newData","id","value","config","headers","token","localStorage","getItem","handleUpload","uploadTask","ref","name","put","on","snapshot","progress","Math","round","bytesTransferred","totalBytes","error","console","log","child","getDownloadURL","then","url","data","patch","params","reportID","reportUrl","success","message","end","endtime","cur","checkTime","diff","single","get","color"],"mappings":";;;;;AAAA,SAASA,QAAT,EAAoBC,SAApB,QAAqC,OAArC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAO,sBAAP,C,CACA;;AACA,SAASC,OAAT,QAAwB,oBAAxB;AACA,OAAOC,KAAP,MAAkB,mBAAlB;AACA,OAAOC,MAAP,MAAmB,QAAnB;;AACA,MAAMC,cAAc,GAAG,CAAC;AAACC,EAAAA;AAAD,CAAD,KAAa;AAAA;;AAClC,QAAM,CAACC,GAAD,EAAMC,MAAN,IAAgBT,QAAQ,CAAC,IAAD,CAA9B;AACA,QAAM,CAACU,IAAD,EAAOC,OAAP,IAAkBX,QAAQ,EAAhC;AACA,QAAM,CAACY,KAAD,EAAQC,QAAR,IAAoBb,QAAQ,CAAC;AACjCY,IAAAA,KAAK,EAAE;AAD0B,GAAD,CAAlC;AAGA,QAAM,CAACE,WAAD,EAAcC,cAAd,IAAgCf,QAAQ,CAAC,KAAD,CAA9C;;AACA,QAAMgB,OAAO,GAAG,MAAMD,cAAc,CAAC,IAAD,CAApC;;AAEA,QAAME,YAAY,GAAGC,CAAC,IAAI;AACxB,QAAIA,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAJ,EAAuB;AACrBX,MAAAA,MAAM,CAACS,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAN;AACD;AACF,GAJD;;AAKA,WAASC,MAAT,CAAgBH,CAAhB,EAAkB;AAChB,UAAMI,OAAO,GAAG,EAAC,GAAGV;AAAJ,KAAhB;AACAU,IAAAA,OAAO,CAACJ,CAAC,CAACC,MAAF,CAASI,EAAV,CAAP,GAAqBL,CAAC,CAACC,MAAF,CAASK,KAA9B;AACAX,IAAAA,QAAQ,CAACS,OAAD,CAAR;AACD;;AACD,QAAMG,MAAM,GAAG;AACbC,IAAAA,OAAO,EAAE;AACP,sBAAgB,kBADT;AAEPC,MAAAA,KAAK,EAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB;AAFD;AADI,GAAf;;AAMA,QAAMC,YAAY,GAAG,CAACtB,GAAD,EAAKI,KAAL,KAAe;AAClC,UAAMmB,UAAU,GAAG5B,OAAO,CAAC6B,GAAR,CAAa,QAAOxB,GAAG,CAACyB,IAAK,EAA7B,EAAgCC,GAAhC,CAAoC1B,GAApC,CAAnB;AACAuB,IAAAA,UAAU,CAACI,EAAX,CACE,eADF,EAEGC,QAAD,IAAc;AACZ,YAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CACdH,QAAQ,CAACI,gBAAT,GAA4BJ,QAAQ,CAACK,UAAtC,GAAoD,GADrC,CAAjB;AAGD,KANH,EAOGC,KAAD,IAAW;AACTtC,MAAAA,KAAK,CAAC,oBAAD,EAAuB,OAAvB,CAAL;AACAuC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACD,KAVH,EAWE,MAAM;AACHvC,MAAAA,OAAO,CACL6B,GADF,CACM,MADN,EAEEa,KAFF,CAEQrC,GAAG,CAACyB,IAFZ,EAGEa,cAHF,GAIEC,IAJF,CAIO,MAAOC,GAAP,IAAe;AACnB,cAAM;AAACC,UAAAA;AAAD,YAAS,MAAM/C,KAAK,CAACgD,KAAN,CAClB,yCAAwC3C,KAAK,CAAC4C,MAAN,CAAaC,QAAS,EAD5C,EAEnB;AAAExC,UAAAA,KAAK,EAAEA,KAAT;AAAgByC,UAAAA,SAAS,EAAGL;AAA5B,SAFmB,EAGnBvB,MAHmB,CAArB;;AAKA,YAAGwB,IAAI,CAACK,OAAL,KAAiB,IAApB,EAA0B;AAC1BlD,UAAAA,KAAK,CAAC6C,IAAI,CAACM,OAAN,EAAe,SAAf,CAAL;AACC;AACF,OAbF;AAcF,KA1BH;AA4BD,GA9BD;;AAgCAtD,EAAAA,SAAS,CAAE,YAAW;AACpB,UAAOuD,GAAG,GAAGnD,MAAM,CAACE,KAAK,CAAC4C,MAAN,CAAaM,OAAd,CAAnB;AACA,UAAMC,GAAG,GAAGrD,MAAM,EAAlB;AACA,QAAIsD,SAAS,GAAGH,GAAG,CAACI,IAAJ,CAASF,GAAT,EAAc,MAAd,CAAhB;AACAf,IAAAA,OAAO,CAACC,GAAR,CAAYe,SAAZ;;AACA,QAAGA,SAAS,GAAG,CAAf,EAAkB;AAChBA,MAAAA,SAAS,GAAG,CAAZ;AACD;;AACDhD,IAAAA,OAAO,CAACgD,SAAD,CAAP;;AAEA,QAAG;AACD,YAAME,MAAM,GAAG,MAAM3D,KAAK,CAAC4D,GAAN,CAAW,gBAAevD,KAAK,CAAC4C,MAAN,CAAaC,QAAS,EAAhD,EAAmD3B,MAAnD,CAArB;AACAhB,MAAAA,MAAM,CAACoD,MAAM,CAACZ,IAAR,CAAN;AACApC,MAAAA,QAAQ,CAACgD,MAAM,CAACZ,IAAR,CAAR;AACD,KAJD,CAIC,OAAOP,KAAP,EAAa;AACZC,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ;AACD;AACF,GAjBQ,EAiBP,EAjBO,CAAT;AAoBA;AAAA;AACE;AACA;AACA;AACA;AACA;AACA;AAAK,MAAA,SAAS,EAAC,MAAf;AAAA,8BACE;AAAI,QAAA,SAAS,EAAC,OAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAEE;AAAK,QAAA,SAAS,EAAC,iBAAf;AAAA,+BACE;AAAK,UAAA,SAAS,EAAC,uBAAf;AAAA,kCACE;AAAK,YAAA,SAAS,EAAC,YAAf;AAAA,oCACE;AAAO,cAAA,OAAO,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AAAG,cAAA,KAAK,EAAE;AAACmB,gBAAAA,KAAK,EAAE;AAAR,eAAV;AAAA,sCAAoCrD,IAApC;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAKE;AAAK,YAAA,SAAS,EAAC,YAAf;AAAA,oCACE;AAAO,cAAA,OAAO,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AACE,cAAA,IAAI,EAAC,MADP;AAEE,cAAA,IAAI,EAAC,OAFP;AAGE,cAAA,QAAQ,MAHV;AAIE,cAAA,EAAE,EAAC,OAJL;AAKE,cAAA,KAAK,EAAEE,KAAK,CAACA,KALf;AAME,cAAA,QAAQ,EAAGM,CAAD,IAAKG,MAAM,CAACH,CAAD;AANvB;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,kBALF,eAgBE;AAAK,YAAA,SAAS,EAAC,YAAf;AAAA,oCACE;AAAO,cAAA,OAAO,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AACE,cAAA,IAAI,EAAC,MADP;AAEE,cAAA,IAAI,EAAC,UAFP;AAGE,cAAA,QAAQ,MAHV;AAIE,cAAA,EAAE,EAAC,UAJL;AAKE,cAAA,QAAQ,EAAED;AALZ;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAhBF,eA0BE;AAAO,YAAA,IAAI,EAAC,OAAZ;AAAoB,YAAA,KAAK,EAAC,KAA1B;AAAgC,YAAA,IAAI,EAAC,KAArC;AAA2C,YAAA,OAAO,EAAED;AAApD;AAAA;AAAA;AAAA;AAAA,kBA1BF,mCA2BIF,WAAW,gBAAG;AAAQ,YAAA,OAAO,EAAEI,CAAC,IAAIY,YAAY,CAACtB,GAAD,EAAMI,KAAK,CAACA,KAAZ,CAAlC;AAAsD,YAAA,SAAS,EAAC,iBAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAH,GAA4G,IA3B3H;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AANF;AA0CD,CAvHD;;GAAMN,c;;KAAAA,c;AA0HN,eAAeA,cAAf","sourcesContent":["import { useState , useEffect } from \"react\";\nimport axios from \"axios\";\nimport \"./RegisterScreen.css\";\n// import { handleUpload } from'../constant/uploadWord';\nimport { storage } from \"../config/firebase\";\nimport alert from '../constant/alert';\nimport moment from 'moment';\nconst ReSubmitReport = ({match}) => {\n  const [pdf, setPdf] = useState(null);\n  const [time, setTime] = useState();\n  const [title, setTitle] = useState({\n    title: \"\",\n  });\n  const [showResults, setShowResults] = useState(false);\n  const onClick = () => setShowResults(true);\n\n  const handleChange = e => {\n    if (e.target.files[0]) {\n      setPdf(e.target.files[0]);\n    }\n  };\n  function handle(e){\n    const newData = {...title}\n    newData[e.target.id]=e.target.value\n    setTitle(newData)\n  }\n  const config = {\n    headers: {\n      \"Content-Type\": \"application/json\",\n      token : localStorage.getItem(\"authToken\")\n    },\n  };\n  const handleUpload = (pdf,title) => {\n    const uploadTask = storage.ref(`pdfs/${pdf.name}`).put(pdf);\n    uploadTask.on(\n      \"state_changed\",\n      (snapshot) => {\n        const progress = Math.round(\n          (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n        );\n      },\n      (error) => {\n        alert(\"can not upload pdf\", \"error\");\n        console.log(error);\n      },\n      () => {\n         storage\n          .ref(\"pdfs\")\n          .child(pdf.name)\n          .getDownloadURL()\n          .then(async (url) => {\n            const {data} = await axios.patch(\n              `/homeStudent/lstFaculty/report/upload/${match.params.reportID}`,\n              { title: title, reportUrl:  url},\n              config\n            );\n            if(data.success === true) {\n            alert(data.message, \"success\");\n            }\n          });\n      }\n    );\n  };\n\n  useEffect( async ()=> {\n    const  end = moment(match.params.endtime);\n    const cur = moment();\n    let checkTime = end.diff(cur, 'days');\n    console.log(checkTime);\n    if(checkTime < 0) {\n      checkTime = 0\n    }\n    setTime(checkTime)\n\n    try{\n      const single = await axios.get(`/homeStudent/${match.params.reportID}`, config);\n      setPdf(single.data);\n      setTitle(single.data);\n    }catch (error){\n      console.log(\"error\");\n    }\n  },[])\n\n\n  return (\n    // <div>\n    //   <input type=\"file\" onChange={handleChange} />\n    //   <p>{time}</p>\n    //   <button onClick={e => handleUpload(pdf)}>Upload</button>\n    // </div>\n    <div className=\"data\">\n      <h1 className=\"title\">Faculty / Re-Submit Report</h1>\n      <div className=\"register-screen\">\n        <div className=\"register-screen__form\">\n          <div className=\"form-group\">\n            <label htmlFor=\"email\">Time to upload</label>\n            <p style={{color: \"red\"}}>You have {time} day to submit report</p>\n          </div>\n          <div className=\"form-group\">\n            <label htmlFor=\"name\">Title:</label>\n            <input\n              type=\"text\"\n              name=\"title\"\n              required\n              id=\"title\"\n              value={title.title}\n              onChange={(e)=>handle(e)}\n            />\n          </div>     \n          <div className=\"form-group\">\n            <label htmlFor=\"name\">File:</label>\n            <input\n              type=\"file\"\n              name=\"fileName\"\n              required\n              id=\"fileName\"\n              onChange={handleChange}\n            />\n          </div>\n          <input type=\"radio\" value=\"law\" name=\"law\" onClick={onClick} /> Accept all law of university\n          { showResults ? <button onClick={e => handleUpload(pdf, title.title)} className=\"btn btn-primary\" > Re-Submit</button> : null }\n          \n        </div>\n      </div>\n    </div>\n  );\n};\n\n\nexport default ReSubmitReport;"]},"metadata":{},"sourceType":"module"}